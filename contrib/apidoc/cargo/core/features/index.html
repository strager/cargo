<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Support for nightly features in Cargo itself."><meta name="keywords" content="rust, rustlang, rust-lang, features"><title>cargo::core::features - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../../../normalize.css"><link rel="stylesheet" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../../../ayu.css" disabled><link rel="stylesheet" href="../../../dark.css" disabled><link rel="stylesheet" href="../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../storage.js"></script><script defer src="../../../main.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../cargo/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../cargo/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module features</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press â€˜Sâ€™ to search, â€˜?â€™ for more optionsâ€¦" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../../index.html">cargo</a>::<wbr><a href="../index.html">core</a>::<wbr><a class="mod" href="#">features</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/cargo/core/features.rs.html#1-1063">source</a> Â· <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Support for nightly features in Cargo itself.</p>
<p>This file is the version of <code>feature_gate.rs</code> in upstream Rust for Cargo
itself and is intended to be the avenue for which new features in Cargo are
gated by default and then eventually stabilized. All known stable and
unstable features are tracked in this file.</p>
<p>If youâ€™re reading this then youâ€™re likely interested in adding a feature to
Cargo, and the good news is that it shouldnâ€™t be too hard! First determine
how the feature should be gated:</p>
<ul>
<li>New syntax in Cargo.toml should use <code>cargo-features</code>.</li>
<li>New CLI options should use <code>-Z unstable-options</code>.</li>
<li>New functionality that may not have an interface, or the interface has
not yet been designed, or for more complex features that affect multiple
parts of Cargo should use a new <code>-Z</code> flag.</li>
</ul>
<p>See below for more details.</p>
<p>When adding new tests for your feature, usually the tests should go into a
new module of the testsuite. See
<a href="https://doc.crates.io/contrib/tests/writing.html">https://doc.crates.io/contrib/tests/writing.html</a> for more information on
writing tests. Particularly, check out the â€œTesting Nightly Featuresâ€
section for testing unstable features.</p>
<p>After you have added your feature, be sure to update the unstable
documentation at <code>src/doc/src/reference/unstable.md</code> to include a short
description of how to use your new feature.</p>
<p>And hopefully thatâ€™s it!</p>
<h3 id="new-cargotoml-syntax"><a href="#new-cargotoml-syntax">New Cargo.toml syntax</a></h3>
<p>The steps for adding new Cargo.toml syntax are:</p>
<ol>
<li>
<p>Add the cargo-features unstable gate. Search below for â€œlook hereâ€ to
find the <a href="macro.features.html"><code>features!</code></a> macro invocation and add your feature to the list.</p>
</li>
<li>
<p>Update the Cargo.toml parsing code to handle your new feature.</p>
</li>
<li>
<p>Wherever you added the new parsing code, call
<code>features.require(Feature::my_feature_name())?</code> if the new syntax is
used. This will return an error if the user hasnâ€™t listed the feature
in <code>cargo-features</code> or this is not the nightly channel.</p>
</li>
</ol>
<h3 id="-z-unstable-options"><a href="#-z-unstable-options"><code>-Z unstable-options</code></a></h3>
<p><code>-Z unstable-options</code> is intended to force the user to opt-in to new CLI
flags, options, and new subcommands.</p>
<p>The steps to add a new command-line option are:</p>
<ol>
<li>Add the option to the CLI parsing code. In the help text, be sure to
include <code>(unstable)</code> to note that this is an unstable option.</li>
<li>Where the CLI option is loaded, be sure to call
<a href="struct.CliUnstable.html#method.fail_if_stable_opt" title="CliUnstable::fail_if_stable_opt"><code>CliUnstable::fail_if_stable_opt</code></a>. This will return an error if <code>-Z unstable options</code> was not passed.</li>
</ol>
<h3 id="-z-options"><a href="#-z-options"><code>-Z</code> options</a></h3>
<p>The steps to add a new <code>-Z</code> option are:</p>
<ol>
<li>Add the option to the <a href="struct.CliUnstable.html" title="CliUnstable"><code>CliUnstable</code></a> struct below. Flags can take an
optional value if you want.</li>
<li>Update the <a href="struct.CliUnstable.html#method.add" title="CliUnstable::add"><code>CliUnstable::add</code></a> function to parse the flag.</li>
<li>Wherever the new functionality is implemented, call
<a href="../../util/config/struct.Config.html#method.cli_unstable"><code>Config::cli_unstable</code></a> to get an instance of <a href="struct.CliUnstable.html" title="CliUnstable"><code>CliUnstable</code></a>
and check if the option has been enabled on the <a href="struct.CliUnstable.html" title="CliUnstable"><code>CliUnstable</code></a> instance.
Nightly gating is already handled, so no need to worry about that.</li>
</ol>
<h3 id="stabilization"><a href="#stabilization">Stabilization</a></h3>
<p>For the stabilization process, see
<a href="https://doc.crates.io/contrib/process/unstable.html#stabilization">https://doc.crates.io/contrib/process/unstable.html#stabilization</a>.</p>
<p>The steps for stabilizing are roughly:</p>
<ol>
<li>Update the feature to be stable, based on the kind of feature:</li>
<li><code>cargo-features</code>: Change the feature to <code>stable</code> in the <a href="macro.features.html"><code>features!</code></a>
macro invocation below, and include the version and a URL for the
documentation.</li>
<li><code>-Z unstable-options</code>: Find the call to <a href="struct.CliUnstable.html#method.fail_if_stable_opt"><code>fail_if_stable_opt</code></a> and
remove it. Be sure to update the man pages if necessary.</li>
<li><code>-Z</code> flag: Change the parsing code in <a href="struct.CliUnstable.html#method.add" title="CliUnstable::add"><code>CliUnstable::add</code></a> to call
<code>stabilized_warn</code> or <code>stabilized_err</code> and remove the field from
<a href="struct.CliUnstable.html" title="CliUnstable"><code>CliUnstable</code></a>. Remove the <code>(unstable)</code> note in the clap help text if
necessary.</li>
<li>Remove <code>masquerade_as_nightly_cargo</code> from any tests, and remove
<code>cargo-features</code> from <code>Cargo.toml</code> test files if any. You can
quickly find what needs to be removed by searching for the name
of the feature, e.g. <code>print_im_a_teapot</code></li>
<li>Update the docs in unstable.md to move the section to the bottom
and summarize it similar to the other entries. Update the rest of the
documentation to add the new feature.</li>
</ol>
</div></details><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.features.html" title="cargo::core::features::features macro">features</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.stab.html" title="cargo::core::features::stab macro">stab</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.unstable_cli_options.html" title="cargo::core::features::unstable_cli_options macro">unstable_cli_options</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CliUnstable.html" title="cargo::core::features::CliUnstable struct">CliUnstable</a></div><div class="item-right docblock-short">A parsed representation of all unstable flags that Cargo accepts.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Feature.html" title="cargo::core::features::Feature struct">Feature</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Features.html" title="cargo::core::features::Features struct">Features</a></div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Edition.html" title="cargo::core::features::Edition enum">Edition</a></div><div class="item-right docblock-short">The edition of the compiler (<a href="https://rust-lang.github.io/rfcs/2052-epochs.html">RFC 2052</a>)</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Status.html" title="cargo::core::features::Status enum">Status</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div></div><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.HIDDEN.html" title="cargo::core::features::HIDDEN constant">HIDDEN</a></div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.SEE_CHANNELS.html" title="cargo::core::features::SEE_CHANNELS constant">SEE_CHANNELS</a></div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILISED_MULTITARGET.html" title="cargo::core::features::STABILISED_MULTITARGET constant">STABILISED_MULTITARGET</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILISED_NAMESPACED_FEATURES.html" title="cargo::core::features::STABILISED_NAMESPACED_FEATURES constant">STABILISED_NAMESPACED_FEATURES</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_CACHE_MESSAGES.html" title="cargo::core::features::STABILIZED_CACHE_MESSAGES constant">STABILIZED_CACHE_MESSAGES</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_COMPILE_PROGRESS.html" title="cargo::core::features::STABILIZED_COMPILE_PROGRESS constant">STABILIZED_COMPILE_PROGRESS</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_CONFIGURABLE_ENV.html" title="cargo::core::features::STABILIZED_CONFIGURABLE_ENV constant">STABILIZED_CONFIGURABLE_ENV</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_CONFIG_PROFILE.html" title="cargo::core::features::STABILIZED_CONFIG_PROFILE constant">STABILIZED_CONFIG_PROFILE</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_CRATE_VERSIONS.html" title="cargo::core::features::STABILIZED_CRATE_VERSIONS constant">STABILIZED_CRATE_VERSIONS</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_EXTRA_LINK_ARG.html" title="cargo::core::features::STABILIZED_EXTRA_LINK_ARG constant">STABILIZED_EXTRA_LINK_ARG</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_FEATURES.html" title="cargo::core::features::STABILIZED_FEATURES constant">STABILIZED_FEATURES</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_FUTURE_INCOMPAT_REPORT.html" title="cargo::core::features::STABILIZED_FUTURE_INCOMPAT_REPORT constant">STABILIZED_FUTURE_INCOMPAT_REPORT</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_INSTALL_UPGRADE.html" title="cargo::core::features::STABILIZED_INSTALL_UPGRADE constant">STABILIZED_INSTALL_UPGRADE</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_NAMED_PROFILES.html" title="cargo::core::features::STABILIZED_NAMED_PROFILES constant">STABILIZED_NAMED_PROFILES</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_OFFLINE.html" title="cargo::core::features::STABILIZED_OFFLINE constant">STABILIZED_OFFLINE</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_PACKAGE_FEATURES.html" title="cargo::core::features::STABILIZED_PACKAGE_FEATURES constant">STABILIZED_PACKAGE_FEATURES</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_PATCH_IN_CONFIG.html" title="cargo::core::features::STABILIZED_PATCH_IN_CONFIG constant">STABILIZED_PATCH_IN_CONFIG</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_TERMINAL_WIDTH.html" title="cargo::core::features::STABILIZED_TERMINAL_WIDTH constant">STABILIZED_TERMINAL_WIDTH</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_TIMINGS.html" title="cargo::core::features::STABILIZED_TIMINGS constant">STABILIZED_TIMINGS</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.STABILIZED_WEAK_DEP_FEATURES.html" title="cargo::core::features::STABILIZED_WEAK_DEP_FEATURES constant">STABILIZED_WEAK_DEP_FEATURES</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.channel.html" title="cargo::core::features::channel fn">channel</a></div><div class="item-right docblock-short">Returns the current release channel (â€œstableâ€, â€œbetaâ€, â€œnightlyâ€, â€œdevâ€).</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.deserialize_build_std.html" title="cargo::core::features::deserialize_build_std fn">deserialize_build_std</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.deserialize_check_cfg.html" title="cargo::core::features::deserialize_check_cfg fn">deserialize_check_cfg</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.parse_check_cfg.html" title="cargo::core::features::parse_check_cfg fn">parse_check_cfg</a><span title="Restricted Visibility">&nbsp;ğŸ”’</span> </div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="cargo" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.0 (69f9c33d7 2022-12-12)" ></div></body></html>